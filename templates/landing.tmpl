<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ .title }}</title>
  <link rel="stylesheet" href="/styles/theme.css" />
  <style>
    main {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
    }
    aside {
      flex: 1;
      min-width: 200px;
    }
    aside h2 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: #003366;
      border-bottom: 2px solid #003366;
      padding-bottom: 0.5rem;
    }
    aside ul {
      list-style-type: none;
      padding: 0;
    }
    aside li {
      margin-bottom: 0.5rem;
    }
    aside a {
      color: #333;
      text-decoration: none;
      font-size: 1rem;
      transition: color 0.3s ease;
    }
    aside a:hover {
      color: #003366;
    }
    section {
      flex: 3;
      min-width: 300px;
    }
    .card {
      background-color: #fff;
      border: none;
      border-radius: 8px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .card h2 {
      color: #003366;
      margin-top: 0;
      font-size: 1.8rem;
      font-weight: 700;
    }
    /* Styles for search container */
    .search-container {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .search-container input {
      flex: 1;
    }
    input,
    button {
      font-family: "Roboto", Arial, sans-serif;
      padding: 0.75rem;
      font-size: 1rem;
      background-color: #fff;
      color: #333;
      border: 1px solid #ccc;
      border-radius: 4px;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      width: 100%;
    }
    input:focus {
      outline: none;
      border-color: #003366;
      box-shadow: 0 0 0 2px rgba(0, 51, 102, 0.2);
    }
    button {
      background-color: #003366;
      color: #fff;
      border: none;
      cursor: pointer;
      font-weight: 700;
      transition: background-color 0.3s ease;
      width: auto;
      padding: 0.75rem 1.5rem;
    }
    button:hover {
      background-color: #004080;
    }
    .featured-tool {
      display: flex;
      gap: 2rem;
      align-items: center;
    }
    .featured-tool img {
      width: 150px;
      height: 150px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .featured-tool h3 {
      color: #003366;
      margin-top: 0;
      font-size: 1.5rem;
      font-weight: 700;
    }
    .featured-tool a {
      color: #003366;
      text-decoration: none;
      font-weight: 700;
      transition: color 0.3s ease;
    }
    .featured-tool a:hover {
      color: #004080;
    }
    footer {
      background-color: #003366;
      color: #fff;
      text-align: center;
      padding: 1.5rem;
      margin-top: 2rem;
      font-size: 0.9rem;
    }
    footer a {
      color: #ffd700;
      text-decoration: none;
      transition: color 0.3s ease;
    }
    footer a:hover {
      color: #fff;
    }
    /* Additional styles for new sections */
    .result-item {
      border: 1px solid #ddd;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 4px;
    }
    .vulnerability {
      margin-bottom: 1rem;
      padding: 1rem;
      border-radius: 4px;
    }
    .high {
      background-color: #ffe6e6;
    }
    .medium {
      background-color: #fff0e6;
    }
    .upsell {
      background-color: #e6f2ff;
      padding: 1rem;
      border-radius: 4px;
      margin-top: 1rem;
    }
    .upsell button {
      margin-top: 1rem;
    }
    /* Style for back button */
    #report-section button {
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <h1>ZCauldron</h1>
      <div>
        <a href="/login">Login</a>
        <a href="/sign-up">Register</a>
      </div>
    </nav>
  </header>

  <main>
    {{ if .message }}
    <div class="message">{{ .message }}</div>
    {{ end }}
    <aside>
      <h2>Security Tools</h2>
      <ul>
        <li><a href="#">Vulnerability Scanner</a></li>
        <li><a href="#">Dependency Checker</a></li>
        <li><a href="#">Code Auditor</a></li>
      </ul>
    </aside>

    <section>
      <!-- Search Section -->
      <div id="search-section" class="card">
        <h2>Scan Your Package</h2>
        <div class="search-container">
          <input type="text" id="package-name" placeholder="npm Package Name" required />
          <button onclick="handleSearch()">Scan Now</button>
        </div>
      </div>

      <!-- Results Section -->
      <div id="results-section" class="card" style="display: none;">
        <h2>Search Results</h2>
        <div id="results-list"></div>
      </div>

      <!-- Report Section -->
      <div id="report-section" class="card" style="display: none;">
        <h2>Vulnerability Report</h2>
        <div id="report-content"></div>
        <button onclick="showSection('results-section')">Back to Results</button>
      </div>

      <!-- Upsell Section -->
      <div id="upsell-section" class="card" style="display: none;">
        <h2>Get Your Free PDF Guide</h2>
        <p>
          Enter your email to receive "Analyzing and Assessing Risks in NPM Packages"
        </p>
        <input type="email" id="email" placeholder="Your Email" />
        <button onclick="handleUpsellSubmit()">Send Me the Guide</button>
      </div>

      <!-- Featured Tool -->
      <div class="card">
        <h2>Featured Tool</h2>
        <div class="featured-tool">
          <img
            src="/placeholder.svg?height=150&width=150"
            alt="Vulnerability Scanner"
          />
          <div>
            <h3>npm Vulnerability Scanner</h3>
            <p>
              Detect security vulnerabilities in your npm packages before they
              become a threat. Our advanced scanning technology ensures your
              projects remain secure and compliant.
            </p>
            <a href="#">Learn More</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>
      &copy; 2024 ZCauldron | <a href="#">Cybersecurity Tools</a> |
      <a href="/privacy-policy">Privacy Policy</a> | <a href="/terms-of-service">Terms of Service</a>
    </p>
  </footer>

  <!-- JavaScript Logic -->
  <script>
    const dummyData = {
      searchResults: [
        {
          name: "react",
          version: "18.2.0",
          description:
            "React is a JavaScript library for building user interfaces.",
        },
        {
          name: "react-dom",
          version: "18.2.0",
          description: "React package for working with the DOM.",
        },
        {
          name: "react-scripts",
          version: "5.0.1",
          description: "Configuration and scripts for Create React App.",
        },
        {
          name: "express",
          version: "4.17.1",
          description: "Fast, unopinionated, minimalist web framework for Node.js",
        },
        {
          name: "lodash",
          version: "4.17.21",
          description: "A modern JavaScript utility library delivering modularity, performance & extras.",
        },
      ],
      vulnerabilityReports: {
        "react": {
          packageName: "react",
          version: "18.2.0",
          vulnerabilities: [
            {
              severity: "high",
              title: "Prototype Pollution",
              description:
                "Allows an attacker to modify properties of the global Object prototype.",
            },
            {
              severity: "medium",
              title: "Cross-Site Scripting (XSS)",
              description:
                "Enables attackers to inject scripts into web pages viewed by other users.",
            },
          ],
          recommendations: [
            "Update to the latest version",
            "Implement proper input validation",
            "Use a Content Security Policy (CSP)",
          ],
        },
        "express": {
          packageName: "express",
          version: "4.17.1",
          vulnerabilities: [
            {
              severity: "medium",
              title: "Denial of Service",
              description:
                "Potential denial of service vulnerability due to unvalidated input.",
            },
          ],
          recommendations: [
            "Sanitize user inputs",
            "Use rate limiting",
          ],
        },
      },
    };

    function showSection(sectionId) {
      document
        .querySelectorAll("#results-section, #report-section, #upsell-section")
        .forEach((section) => (section.style.display = "none"));
      document.getElementById(sectionId).style.display = "block";
    }

    function handleSearch() {
      const packageName = document.getElementById("package-name").value.trim();
      if (!packageName) return;

      // Simulate API call
      setTimeout(() => {
        // Filter dummy data based on package name
        const filteredResults = dummyData.searchResults.filter(result =>
          result.name.toLowerCase().includes(packageName.toLowerCase())
        );

        const resultsListElement = document.getElementById("results-list");

        if (filteredResults.length > 0) {
          resultsListElement.innerHTML = filteredResults
            .map(
              (result) => `
            <div class="result-item">
              <h3>${result.name}</h3>
              <p>Version: ${result.version}</p>
              <p>${result.description}</p>
              <button onclick="handleSelect('${result.name}')">Select</button>
            </div>
          `
            )
            .join("");
        } else {
          resultsListElement.innerHTML = `<p>No results found for "<strong>${packageName}</strong>". Please try another package.</p>`;
        }

        showSection("results-section");
      }, 500);
    }

    function handleSelect(packageName) {
      // Simulate API call to get vulnerability report
      setTimeout(() => {
        const report = dummyData.vulnerabilityReports[packageName];
        const reportContentElement = document.getElementById("report-content");

        if (report) {
          reportContentElement.innerHTML = `
            <h3>${report.packageName} v${report.version}</h3>
            <h4>Vulnerabilities:</h4>
            ${report.vulnerabilities
              .map(
                (vuln) => `
                <div class="vulnerability ${vuln.severity}">
                  <p><strong>${vuln.title}</strong></p>
                  <p>${vuln.description}</p>
                </div>
              `
              )
              .join("")}
            <h4>Recommendations:</h4>
            <ul>
              ${report.recommendations.map((rec) => `<li>${rec}</li>`).join("")}
            </ul>
            <div class="upsell">
              <p><strong>Want to learn more about assessing risks in NPM packages?</strong></p>
              <button onclick="showSection('upsell-section')">Get Free PDF Guide</button>
            </div>
          `;
        } else {
          reportContentElement.innerHTML = `
            <h3>${packageName}</h3>
            <p>No known vulnerabilities found for this package.</p>
          `;
        }

        showSection("report-section");
      }, 500);
    }

    function handleUpsellSubmit() {
      const email = document.getElementById("email").value;
      if (!email) return;

      // Simulate API call to send PDF
      console.log(`Sending PDF to ${email}`);
      alert("Thank you! The PDF has been sent to your email.");
      showSection("search-section");
    }
  </script>
</body>
</html>